<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.inst.project.admin.service.impl.AdminMngMapper">

	<!-- 관리자 공통코드 1레벨 조회 [S]  -->
	<select id="selectCommList" resultType="AdminCommDTO">
		/*AdminMng_SQL.selectCommList*/
		SELECT COMM_ID
				 , COMM_P_ID
				 , COMM_GROUP_CD
				 , COMM_NM
				 , COMM_USE_YN
				 , COMM_CN
				 , COMM_SORT_NO
				 , COMM_CD
				 , COMM_LVL
				 , COMM_DEL_YN
				 , REG_ID
				 , REG_DT
				 , UPD_ID
				 , UPD_DT
		  FROM TB_COMMON_INFO
		WHERE 1=1
		    AND COMM_DEL_YN = 'N'
		    AND COMM_LVL = 0
		ORDER BY COMM_SORT_NO
	</select>
	<!-- 관리자 공통코드 1레벨 조회 [E]  -->
	
	<!-- 관리자 공통코드 2레벨 조회 [S]  -->
	<select id="selectCommList2" resultType="AdminCommDTO">
		/*AdminMng_SQL.selectCommList2*/
		SELECT COMM_ID
				 , COMM_P_ID
				 , COMM_GROUP_CD
				 , COMM_NM
				 , COMM_USE_YN
				 , COMM_CN
				 , COMM_SORT_NO
				 , COMM_CD
				 , COMM_LVL
				 , COMM_DEL_YN
				 , REG_ID
				 , REG_DT
				 , UPD_ID
				 , UPD_DT
		  FROM TB_COMMON_INFO
		WHERE 1=1
		    AND COMM_DEL_YN = 'N'
		    AND COMM_LVL = 1
		 ORDER BY COMM_SORT_NO
	</select>
	<!-- 관리자 공통코드 2레벨 조회 [E]  -->
	
	<!-- 관리자 공통코드 상세 조회 [S] -->
	<select id="adminCommSelect" parameterType="AdminCommDTO" resultType="AdminCommDTO">
		/*AdminMng_SQL.adminCommSelect*/
		SELECT COMM_ID
				 , COMM_P_ID
				 , ( SELECT COMM_NM FROM TB_COMMON_INFO WHERE COMM_ID = #{commPId} ) AS COMM_P_NM
				 , COMM_GROUP_CD
				 , COMM_NM
				 , COMM_USE_YN
				 , COMM_CN
				 , COMM_SORT_NO
				 , COMM_CD
				 , COMM_LVL
				 , COMM_DEL_YN
				 , REG_ID
				 , REG_DT
				 , UPD_ID
				 , UPD_DT
		  FROM TB_COMMON_INFO
		WHERE 1=1
		    AND COMM_ID = #{commId}
		    AND COMM_DEL_YN = 'N'
	</select>
	<!-- 관리자 공통코드 상세 조회 [E] -->
	
	<!-- 관리자 공통코드 저장 [S] -->
	<insert id="adminCommReg" parameterType="AdminCommDTO">
		/*AdminMng_SQL.adminCommReg*/
		INSERT INTO TB_COMMON_INFO (
		   	  COMM_ID
			, COMM_P_ID
			, COMM_GROUP_CD
			, COMM_NM
			, COMM_USE_YN
			, COMM_CN
			, COMM_SORT_NO
			, COMM_CD
			, COMM_LVL
			, COMM_DEL_YN
			, REG_ID
			, REG_DT
			, UPD_ID
			, UPD_DT
		) VALUES ( 
			  (SELECT FN_GET_UNIQUE_KEY())
			, #{commPId}
			, #{commGroupCd}
			, #{commNm}
			, #{commUseYn}
			, #{commCn}
			, #{commSortNo}
			, #{commCd}
			, #{commLvl}
			, 'N'
			, #{regId}
			, NOW()
			, #{updId}
			, NOW()
		)
	</insert>
	<!-- 관리자 공통코드 저장 [E] -->
	
	<!-- 관리자 공통코드 수정 [S] -->
	<update id="adminCommUpd" parameterType="AdminCommDTO">
  		/*AdminMng_SQL.adminCommUpd*/
	  	UPDATE TB_COMMON_INFO
	     	 SET COMM_GROUP_CD	= #{commGroupCd}
				 , COMM_NM			= #{commNm}
				 , COMM_USE_YN		= #{commUseYn}
				 , COMM_CN			= #{commCn}
				 , COMM_SORT_NO	= #{commSortNo}
				 , COMM_CD			= #{commCd}
				 , COMM_LVL			= #{commLvl}
				 , UPD_ID				= #{updId}
				 , UPD_DT				= NOW()
	    WHERE 1=1
	        AND COMM_ID = #{commId} 
	</update>
	<!-- 관리자 공통코드 수정 [E] -->
	
	<!-- 관리자 공통코드 삭제 [S] -->
	<update id="adminCommDel" parameterType="AdminCommDTO">
  		/*AdminMng_SQL.adminMenuDel*/
	  	UPDATE TB_COMMON_INFO
	     	 SET COMM_DEL_YN = 'Y'
	     	 	  , UPD_ID = #{updId}
	     	 	  , UPD_DT = NOW()
	    WHERE 1=1 
	   	    AND COMM_ID   = #{commId} 
	   	 <if test="commPId == null or commPId == ''">
	   	 	  OR COMM_P_ID = #{commId}
	   	 </if>
	</update>
	<!-- 관리자 공통코드 삭제 [E] -->
	
	<!-- 관리자 메뉴 1레벨 조회 [S] -->
	<select id="selectMenuList" resultType="AdminMenuDTO">
		/*AdminMng_SQL.selectMenuList*/
		SELECT MENU_ID
				 , MENU_P_ID
				 , MENU_NM
				 , MENU_USE_YN
				 , MENU_DEL_YN
				 , MENU_CN
				 , MENU_URL
				 , MENU_LVL
				 , MENU_SORT
 				 , MENU_DEPT_CD
				 , MENU_TEAM_CD
				 , MENU_POSITION_CD
				 , MENU_ICON
				 , REG_ID
				 , REG_DT
				 , UPD_ID
				 , UPD_DT
		  FROM TB_ADMIN_MENU_INFO
		WHERE 1=1
		    AND MENU_DEL_YN = 'N'
		    AND MENU_LVL = 0
		ORDER BY MENU_SORT
	</select>
	<!-- 관리자 메뉴 1레벨 조회 [E] -->
	
	<!-- 관리자 메뉴 2레벨 조회 [S] -->
	<select id="selectMenuList2" resultType="AdminMenuDTO">
		/*AdminMng_SQL.selectMenuList2*/
		SELECT MENU_ID
				 , MENU_P_ID
				 , MENU_NM
				 , MENU_USE_YN
				 , MENU_DEL_YN
				 , MENU_CN
				 , MENU_URL
				 , MENU_LVL
				 , MENU_SORT
				 , MENU_DEPT_CD
				 , MENU_TEAM_CD
				 , MENU_POSITION_CD
				 , MENU_ICON
				 , REG_ID
				 , REG_DT
				 , UPD_ID
				 , UPD_DT
		  FROM TB_ADMIN_MENU_INFO
		WHERE 1=1
		    AND MENU_DEL_YN = 'N'
		    AND MENU_LVL = 1
		 ORDER BY MENU_SORT
	</select>
	<!-- 관리자 메뉴 2레벨 조회 [E] -->
	
	<!-- 관리자 메뉴 상세 조회 [S] -->
	<select id="adminMenuSelect" parameterType="AdminMenuDTO" resultType="AdminMenuDTO">
		/*AdminMng_SQL.adminMenuSelect*/
		SELECT MENU_ID
				 , MENU_P_ID
				 , ( SELECT MENU_NM FROM TB_ADMIN_MENU_INFO WHERE MENU_ID = #{menuPId} ) AS MENU_P_NM
				 , MENU_NM
				 , MENU_USE_YN
				 , MENU_DEL_YN
				 , MENU_CN
				 , MENU_URL
				 , MENU_LVL
				 , MENU_SORT
				 , MENU_DEPT_CD
				 , MENU_TEAM_CD
				 , MENU_POSITION_CD
				 , MENU_ICON
				 , REG_ID
				 , REG_DT
				 , UPD_ID
				 , UPD_DT
		  FROM TB_ADMIN_MENU_INFO
		WHERE 1=1
		    AND MENU_ID = #{menuId}
		    AND MENU_DEL_YN = 'N'
	</select>
	<!-- 관리자 메뉴 상세 조회 [E] -->
	
	<!-- 관리자 메뉴 상세조회 결과로 부서코드 조회 [S] -->
	<select id="adminMenuDeptCdSelect" parameterType="string" resultType="map">
	    SELECT ADMIN_UNIT_CD as cd
				 , ADMIN_UNIT_NM as text
	      FROM TB_ADMIN_UNIT_INFO
	    WHERE 1=1
	        AND ADMIN_UNIT_CD = ANY (STRING_TO_ARRAY(#{menuDeptCd}, ','))
	    	AND ADMIN_UNIT_USE_YN = 'Y'
		    AND ADMIN_UNIT_DEL_YN = 'N' 
	</select>
	<!-- 관리자 메뉴 상세조회 결과로 부서코드 조회 [E] -->
	
	<!-- 관리자 메뉴 저장 [S] -->
	<insert id="adminMenuReg" parameterType="AdminMenuDTO">
		/*AdminMng_SQL.adminMenuReg*/
		INSERT INTO TB_ADMIN_MENU_INFO (
			  MENU_ID
			, MENU_P_ID
			, MENU_NM
			, MENU_URL
			, MENU_USE_YN
			, MENU_DEL_YN
			, MENU_CN
			, MENU_LVL
			, MENU_SORT
			, MENU_DEPT_CD
			, MENU_TEAM_CD
			, MENU_POSITION_CD
			, MENU_ICON
			, REG_ID
			, REG_DT
			, UPD_ID
			, UPD_DT
		) VALUES ( 
			  (SELECT FN_GET_UNIQUE_KEY())
			, #{menuPId}
			, #{menuNm}
			, #{menuUrl}
			, #{menuUseYn}
			, 'N'
			, #{menuCn}
			, #{menuLvl}
			, #{menuSort}
			, #{menuDeptCd}
			, #{menuTeamCd}
			, #{menuPositionCd}
			, #{menuIcon}
			, #{regId}
			, NOW()
			, #{updId}
			, NOW()
		)
	</insert>
	<!-- 관리자 메뉴 저장 [E] -->
	
	<!-- 관리자 메뉴 수정 [S] -->
	<update id="adminMenuUpd" parameterType="AdminMenuDTO">
  		/*AdminMng_SQL.adminMenuDel*/
	  	UPDATE TB_ADMIN_MENU_INFO
	     	 SET MENU_NM 				= #{menuNm}
				 , MENU_URL				= #{menuUrl}
				 , MENU_USE_YN			= #{menuUseYn}
				 , MENU_CN					= #{menuCn}
				 , MENU_LVL				= #{menuLvl}
				 , MENU_SORT				= #{menuSort}
				 , MENU_DEPT_CD		= #{menuDeptCd}
				 , MENU_TEAM_CD		= #{menuTeamCd}
				 , MENU_POSITION_CD	= #{menuPositionCd}
				 , MENU_ICON				= #{menuIcon}
				 , UPD_ID					= #{updId}
				 , UPD_DT					= NOW()
	   WHERE 1=1 
	   	   AND MENU_ID = #{menuId} 
	</update>
	<!-- 관리자 메뉴 수정 [E] -->
	
	<!-- 관리자 메뉴 삭제 [S] -->
	<update id="adminMenuDel" parameterType="AdminMenuDTO">
  		/*AdminMng_SQL.adminMenuDel*/
	  	UPDATE TB_ADMIN_MENU_INFO
	     	 SET MENU_DEL_YN = 'Y'
	     	   	  , UPD_ID = #{updId}
	     	 	  , UPD_DT = NOW()
	    WHERE 1=1 
	   	    AND MENU_ID   = #{menuId} 
 	   	 <if test="menuPId == null or menuPId == ''">
	   	 	  OR MENU_P_ID = #{menuId}
	   	 </if>
	</update>
	<!-- 관리자 메뉴 삭제 [E] -->
	
	<!-- 관리자 유닛 조회 [S] -->
	<select id="selectUnitAllList" resultType="AdminUnitDTO">
		/*AdminMng_SQL.selectUnitAllList*/ 
		SELECT ADMIN_UNIT_ID
				  , ADMIN_UNIT_P_ID
				  , ADMIN_UNIT_CD
				  , ADMIN_UNIT_NM
				  , ADMIN_UNIT_LVL
				  , ADMIN_UNIT_SORT_NO
				  , ADMIN_UNIT_USE_YN
				  , ADMIN_UNIT_DEL_YN
				  , REG_ID
				  , REG_DT
				  , UPD_ID
				  , UPD_DT
		   FROM TB_ADMIN_UNIT_INFO
		 WHERE 1=1
		     AND ADMIN_UNIT_USE_YN = 'Y'
		     AND ADMIN_UNIT_DEL_YN = 'N'
		 ORDER BY ADMIN_UNIT_LVL
	</select>
	<!-- 관리자 유닛 조회 [E] -->
	
	<!-- 관리자 유닛 1레벨 조회 [S] -->
	<select id="selectUnitList" resultType="AdminUnitDTO">
		/*AdminMng_SQL.selectUnitList*/
		SELECT ADMIN_UNIT_ID
				 , ADMIN_UNIT_P_ID
				 , ADMIN_UNIT_CD
				 , ADMIN_UNIT_NM
				 , ADMIN_UNIT_LVL
				 , ADMIN_UNIT_SORT_NO
				 , ADMIN_UNIT_USE_YN
				 , ADMIN_UNIT_DEL_YN
				 , REG_ID
				 , REG_DT
				 , UPD_ID
				 , UPD_DT
		  FROM TB_ADMIN_UNIT_INFO
		WHERE 1=1
		    AND ADMIN_UNIT_DEL_YN = 'N'
		    AND ADMIN_UNIT_LVL = 0
		 ORDER BY ADMIN_UNIT_SORT_NO
	</select>
	<!-- 관리자 유닛 1레벨 조회 [E] -->
	
	<!-- 관리자 유닛 2레벨 조회 [S] -->
	<select id="selectUnitList2" resultType="AdminUnitDTO">
		/*AdminMng_SQL.selectUnitList2*/
		SELECT ADMIN_UNIT_ID
				 , ADMIN_UNIT_P_ID
				 , ADMIN_UNIT_CD
				 , ADMIN_UNIT_NM
				 , ADMIN_UNIT_LVL
				 , ADMIN_UNIT_SORT_NO
				 , ADMIN_UNIT_USE_YN
				 , ADMIN_UNIT_DEL_YN
				 , REG_ID
				 , REG_DT
				 , UPD_ID
				 , UPD_DT
		  FROM TB_ADMIN_UNIT_INFO
		WHERE 1=1
		    AND ADMIN_UNIT_DEL_YN = 'N'
		    AND ADMIN_UNIT_LVL = 1
		 ORDER BY ADMIN_UNIT_SORT_NO
	</select>
	<!-- 관리자 유닛 2레벨 조회 [E] -->
	
	<!-- 관리자 유닛 3레벨 조회 [S] -->
	<select id="selectUnitList3" resultType="AdminUnitDTO">
		/*AdminMng_SQL.selectUnitList3*/
		SELECT ADMIN_UNIT_ID
				 , ADMIN_UNIT_P_ID
				 , ADMIN_UNIT_CD
				 , ADMIN_UNIT_NM
				 , ADMIN_UNIT_LVL
				 , ADMIN_UNIT_SORT_NO
				 , ADMIN_UNIT_USE_YN
				 , ADMIN_UNIT_DEL_YN
				 , REG_ID
				 , REG_DT
				 , UPD_ID
				 , UPD_DT
		  FROM TB_ADMIN_UNIT_INFO 
		WHERE 1=1
		    AND ADMIN_UNIT_DEL_YN = 'N'
		    AND ADMIN_UNIT_LVL = 2
		 ORDER BY ADMIN_UNIT_SORT_NO  
	</select>
	<!-- 관리자 유닛 3레벨 조회 [E] -->
	
	<!-- 관리자 부서 상세 조회 [S] -->
	<select id="adminUnitSelect" parameterType="AdminUnitDTO" resultType="AdminUnitDTO">
		/*AdminMng_SQL.adminUnitSelect*/
		SELECT ADMIN_UNIT_ID
				 , ADMIN_UNIT_NM
				 , ADMIN_UNIT_P_ID
				 , ( SELECT ADMIN_UNIT_NM FROM TB_ADMIN_UNIT_INFO WHERE ADMIN_UNIT_ID = #{adminUnitPId} ) AS ADMIN_UNIT_P_NM
				 , ADMIN_UNIT_CD
				 , ADMIN_UNIT_LVL
				 , ADMIN_UNIT_SORT_NO
				 , ADMIN_UNIT_USE_YN
				 , REG_ID
				 , REG_DT
				 , UPD_ID
				 , UPD_DT
		  FROM TB_ADMIN_UNIT_INFO
		WHERE 1=1
		    AND ADMIN_UNIT_ID = #{adminUnitId}
		    AND ADMIN_UNIT_DEL_YN = 'N'
	</select>
	<!-- 관리자 부서 상세 조회 [E] -->

	<!-- 관리자 부서 등록 [S] -->
	<insert id="adminUnitReg" parameterType="AdminUnitDTO">
		/*AdminMng_SQL.adminMenuReg*/
		INSERT INTO TB_ADMIN_UNIT_INFO (
			  ADMIN_UNIT_ID
			, ADMIN_UNIT_NM
			, ADMIN_UNIT_P_ID
			, ADMIN_UNIT_CD
			, ADMIN_UNIT_LVL
			, ADMIN_UNIT_SORT_NO
			, ADMIN_UNIT_CN
			, ADMIN_UNIT_USE_YN
			, ADMIN_UNIT_DEL_YN
			, REG_ID
			, REG_DT
			, UPD_ID
			, UPD_DT
		) VALUES ( 
			  (SELECT FN_GET_UNIQUE_KEY())
			, #{adminUnitNm}
			, #{adminUnitPId}
			, #{adminUnitCd}
			, #{adminUnitLvl}
			, #{adminUnitSortNo}
			, #{adminUnitCn}
			, #{adminUnitUseYn}
			, 'N'
			, #{regId}
			, NOW()
			, #{updId}
			, NOW()
		)
	</insert>
	<!-- 관리자 부서 등록 [E] -->
	
	<!-- 관리자 부서 수정 [S] -->
	<update id="adminUnitUpd" parameterType="AdminUnitDTO">
  		/*AdminMng_SQL.adminUnitUpd*/
	  	UPDATE TB_ADMIN_UNIT_INFO
	     	 SET ADMIN_UNIT_NM 			= #{adminUnitNm}
				 , ADMIN_UNIT_CD			= #{adminUnitCd}
				 , ADMIN_UNIT_LVL			= #{adminUnitLvl}
				 , ADMIN_UNIT_SORT_NO	= #{adminUnitSortNo}
				 , ADMIN_UNIT_CN			= #{adminUnitCn}
				 , ADMIN_UNIT_USE_YN		= #{adminUnitUseYn}
				 , UPD_ID						= #{updId}
				 , UPD_DT						= NOW()
	   WHERE 1=1 
	   	   AND ADMIN_UNIT_ID = #{adminUnitId} 
	</update>
	<!-- 관리자 부서 수정 [E] -->

	<!-- 관리자 부서 삭제 [S] -->
	<update id="adminUnitDel" parameterType="AdminUnitDTO">
  		/*AdminMng_SQL.adminUnitDel*/
	  	UPDATE TB_ADMIN_UNIT_INFO
	     	  SET ADMIN_UNIT_DEL_YN = 'Y'
	     	  	   , UPD_ID = #{updId}
	     	 	   , UPD_DT = NOW()
	   	 WHERE 1=1 
	   	 	 AND ADMIN_UNIT_ID   = #{adminUnitId} 
 	   	 <if test="adminUnitPId == null or adminUnitPId == ''">
	   	 	  OR ADMIN_UNIT_P_ID = #{adminUnitPId}
	   	 </if>
	</update>
	<!-- 관리자 부서 삭제 [E] -->
	
	<!-- 관리자 총 건수 조회 [S] -->
	<select id="selectAdminUserTotalCount" parameterType="PagerUtil" resultType="Long">
		/*AdminMng_SQL.selectAdminUserTotalCount*/
    	SELECT COUNT(*)
	      FROM TB_ADMIN_INFO
	    WHERE 1=1
		 	AND ADMIN_REG_ACCEPT = 'Y'
	    <if test="searchGb == 'adminNm'">
		    AND ADMIN_NM LIKE CONCAT('%', #{searchTxt}, '%')
	    </if>
	    <if test="searchGb == 'adminId'">
			AND ADMIN_ID LIKE CONCAT('%', #{searchTxt}, '%')
	    </if>
	</select>
	<!-- 관리자 총 건수 조회 [E] -->
	
	<!-- 관리자 조회 [S] -->
	<select id="selectAdminUser" parameterType="PagerUtil"  resultType="AdminDTO">
		/*AdminMng_SQL.selectAdminUser*/
		SELECT ADMIN_NO
				  , ADMIN_ID
				  , ADMIN_PW
				  , ADMIN_NM
				  , ADMIN_PH
				  , ADMIN_POST_CD
				  , ADMIN_ADDRESS
				  , ADMIN_D_ADDRESS
				  , ADMIN_DEL_YN
				  , CASE WHEN ADMIN_DEL_YN = 'Y' THEN '삭제'
				  		     WHEN ADMIN_DEL_YN = 'N' THEN '미삭제'
				  		     ELSE NULL END AS ADMIN_DEL_YN_NM
				  , ADMIN_DEPT_CD
				  , ( SELECT b.ADMIN_UNIT_NM 
				  		 FROM TB_ADMIN_UNIT_INFO b 
				  	   WHERE ADMIN_DEPT_CD = b.ADMIN_UNIT_CD ) AS ADMIN_DEPT_NM
				  , ADMIN_TEAM_CD
				  , ( SELECT b.ADMIN_UNIT_NM 
				         FROM TB_ADMIN_UNIT_INFO b 
				       WHERE ADMIN_TEAM_CD = b.ADMIN_UNIT_CD ) AS ADMIN_TEAM_NM
				  , ADMIN_POSITION_CD
				  , ( SELECT b.ADMIN_UNIT_NM 
				         FROM TB_ADMIN_UNIT_INFO b 
				       WHERE ADMIN_POSITION_CD = b.ADMIN_UNIT_CD ) AS ADMIN_POSITION_NM
				  , ADMIN_CN
				  , ADMIN_GENDER
				  , CASE WHEN ADMIN_GENDER = 'M' THEN '남자'
				 		     WHEN ADMIN_GENDER = 'W' THEN '여자'
				 		   	   ELSE NULL END AS ADMIN_GENDER_NM
				  , ADMIN_REG_GB
				  , ADMIN_GRADE_CD
				  , ADMIN_REG_ACCEPT
				  , REG_ID
				  , REG_DT
				  , UPD_ID
				  , UPD_DT
		   FROM TB_ADMIN_INFO
		 WHERE 1=1 
		 	 AND ADMIN_REG_ACCEPT = 'Y'
	    <if test="searchGb == 'adminNm'">
		     AND ADMIN_NM LIKE CONCAT('%', #{searchTxt}, '%')
	    </if>
	    <if test="searchGb == 'adminId'">
		     AND ADMIN_ID LIKE CONCAT('%', #{searchTxt}, '%')
	    </if>
         ORDER BY UPD_DT DESC 
           LIMIT #{perPage} OFFSET #{startRow}
	</select>
	<!-- 관리자 조회 [E] -->
	
	<!-- 관리자 등급 조회 [S] -->
	<select id="selectAdminGradeList" resultType="AdminCommDTO">
		/*AdminMng_SQL.selectAdminGradeList*/
		SELECT COMM_CD 
				  , COMM_NM
		  FROM TB_COMMON_INFO
		WHERE 1=1
		    AND COMM_GROUP_CD = 'ADMGRADE'
		    AND COMM_USE_YN = 'Y'
		    AND COMM_DEL_YN = 'N'
		    AND COMM_LVL != 0
   ORDER BY COMM_SORT_NO ASC;
	</select>
	<!-- 관리자 등급 조회 [E] -->
	
	<!-- 관리자 등록 [S] -->
	<insert id="adminUserReg" parameterType="AdminDTO">
		/*AdminMng_SQL.adminUserReg*/
		INSERT INTO TB_ADMIN_INFO (
		 	  ADMIN_NO
			, ADMIN_ID
			, ADMIN_NM
			, ADMIN_PH
			, ADMIN_POST_CD
			, ADMIN_ADDRESS
			, ADMIN_D_ADDRESS
			, ADMIN_DEL_YN
			, ADMIN_DEPT_CD
			, ADMIN_TEAM_CD
			, ADMIN_POSITION_CD
			, ADMIN_CN
			, ADMIN_GENDER
			, ADMIN_REG_GB
			, ADMIN_GRADE_CD
			, ADMIN_REG_ACCEPT
			, REG_ID
			, REG_DT
			, UPD_ID
			, UPD_DT
		) VALUES (
			(SELECT FN_GET_UNIQUE_KEY())
			, #{adminId}
			, #{adminNm}
			, #{adminPh}
			, #{adminPostCd}
			, #{adminAddress}
			, #{adminDAddress}
			, 'N'
			, #{adminDeptCd}
			, #{adminTeamCd}
			, #{adminPositionCd}
			, #{adminCn}
			, #{adminGender}
			, '01'
			, #{adminGradeCd}
			, 'Y'
			, #{regId}
			, NOW()
			, #{updId}
			, NOW()
		);
	</insert>
	<!-- 관리자 등록 [E] -->
	
	<!-- 관리자 삭제 [S] -->
	<update id="adminUserUpd" parameterType="AdminDTO">
  		/*AdminMng_SQL.adminUserUpd*/
	  	UPDATE TB_ADMIN_INFO
	     	  SET ADMIN_DEL_YN = 'Y'
				  , UPD_ID = #{updId}
				  , UPD_DT = NOW()
		WHERE 1=1
		    AND ADMIN_NO = #{adminNo}
		    AND ADMIN_ID = ${adminId}
	</update>
	<!-- 관리자 삭제 [E] -->
	
	<!-- 관리자 수정 [S] -->
	<update id="adminUserDel" parameterType="AdminDTO">
  		/*AdminMng_SQL.adminUserDel*/
	  	UPDATE TB_ADMIN_INFO
	     	  SET ADMIN_ID 					= #{adminId}
				  , ADMIN_NM 					= #{adminNm}
				  , ADMIN_PH 					= #{adminPh}
				  , ADMIN_POST_CD 			= #{adminPostCd}
				  , ADMIN_ADDRESS 			= #{adminAddress}
				  , ADMIN_D_ADDRESS 		= #{adminDAddress}
				  , ADMIN_DEPT_CD 			= #{adminDeptCd}
				  , ADMIN_TEAM_CD 			= #{adminTeamCd}
				  , ADMIN_POSITION_CD 	= #{adminPositionCd}
				  , ADMIN_CN 					= #{adminCn}
				  , ADMIN_GENDER 			= #{adminGender}
				  , ADMIN_GRADE_CD 		= #{adminGradeCd}
				  , UPD_ID 						= #{updId}
				  , UPD_DT 						= NOW()
		WHERE 1=1
		    AND ADMIN_NO = #{adminNo}
	</update>
	<!-- 관리자 수정 [E] -->
	
	<!-- 관리자 부서 상세 조회 [S] -->
	<resultMap id="adminTeamMap" type="map">
	  <result column="ADMIN_UNIT_ID" property="adminUnitId"/>
	  <result column="ADMIN_UNIT_NM" property="adminUnitNm"/>
	  <result column="ADMIN_UNIT_CD" property="adminUnitCd"/>
	</resultMap>

	<select id="selectAdminTeamList" parameterType="String" resultMap="adminTeamMap">
		/*AdminMng_SQL.selectAdminTeamList*/
		SELECT ADMIN_UNIT_ID 
				 , ADMIN_UNIT_NM
				 , ADMIN_UNIT_CD
		  FROM TB_ADMIN_UNIT_INFO
		WHERE 1=1
		    AND ADMIN_UNIT_P_ID = #{adminUnitId}
		    AND ADMIN_UNIT_LVL = '1'
		    AND ADMIN_UNIT_DEL_YN = 'N'
	ORDER BY ADMIN_UNIT_SORT_NO ASC
	</select>
	
	<select id="selectAdminPositionList" parameterType="String" resultMap="adminTeamMap">
		/*AdminMng_SQL.selectAdminPositionList*/
		SELECT ADMIN_UNIT_ID 
				 , ADMIN_UNIT_NM
				 , ADMIN_UNIT_CD
		  FROM TB_ADMIN_UNIT_INFO
		WHERE 1=1
		    AND ADMIN_UNIT_P_ID = #{adminUnitId}
		    AND ADMIN_UNIT_LVL = '2'
		    AND ADMIN_UNIT_DEL_YN = 'N'
    ORDER BY ADMIN_UNIT_SORT_NO ASC
	</select>
	<!-- 관리자 부서 상세 조회 [E] -->
	
	<!-- 관리자 관리자 정보 조회 [S] -->
	<select id="selectAdminUserInfo" resultType="AdminDTO">
		/*AdminMng_SQL.selectAdminUserInfo*/  
		SELECT ADMIN_NO
				 , ADMIN_ID
				 , ADMIN_PW
				 , ADMIN_NM
				 , ADMIN_POSITION_CD
				 , ADMIN_PH
				 , ADMIN_POST_CD
				 , ADMIN_ADDRESS
				 , ADMIN_D_ADDRESS
				 , ADMIN_DEL_YN
				 , ADMIN_DEPT_CD
				 , ADMIN_TEAM_CD
				 , ADMIN_CN
				 , ADMIN_GENDER
				 , ADMIN_REG_GB
				 , ADMIN_GRADE_CD
				 , ADMIN_REG_ACCEPT
				 , REG_ID
				 , REG_DT
				 , UPD_ID
				 , UPD_DT
		FROM TB_ADMIN_INFO
	  WHERE 1=1 
	      AND ADMIN_NO = #{adminNo}
	      AND ADMIN_ID = #{adminId}
	</select>
	<!-- 관리자 관리자 정보 조회 [E] -->
	
	<!-- 관리자 가입승인관리 총 건수 조회 [S] -->
	<select id="selectAdminUserAcceptTotalCount" parameterType="PagerUtil" resultType="Long">
		/*AdminMng_SQL.selectAdminUserAcceptTotalCount*/
    	SELECT COUNT(*)
	      FROM TB_ADMIN_INFO
	    WHERE 1=1
		     AND ADMIN_REG_ACCEPT != 'Y'
		     AND ADMIN_REG_GB = '00'
	    <if test="searchGb == 'adminNm'">
		    AND ADMIN_NM LIKE CONCAT('%', #{searchTxt}, '%')
	    </if>
	    <if test="searchGb == 'adminId'">
			AND ADMIN_ID LIKE CONCAT('%', #{searchTxt}, '%')
	    </if>
	</select>
	<!-- 관리자 가입승인관리 총 건수 조회 [E] -->
	
	<!-- 관리자 가입승인관리 조회 [S] -->
	<select id="selectAdminUserAcceptInfo" resultType="AdminDTO">
		/*AdminMng_SQL.selectAdminUserAcceptInfo*/
		SELECT ADMIN_NO
				  , ADMIN_ID
				  , ADMIN_NM
				  , ADMIN_PH
				  , ADMIN_POST_CD
				  , ADMIN_ADDRESS
				  , ADMIN_D_ADDRESS
				  , ADMIN_GENDER
				  , CASE WHEN ADMIN_GENDER = 'M' THEN '남자'
				 		     WHEN ADMIN_GENDER = 'W' THEN '여자'
				 		   	   ELSE NULL END AS ADMIN_GENDER_NM
				  , ADMIN_REG_GB
				  , ADMIN_REG_ACCEPT
				  , CASE WHEN ADMIN_REG_ACCEPT = 'N' THEN '미승인'
			 		         WHEN ADMIN_REG_ACCEPT = 'R' THEN '반려'
		 		   	           ELSE NULL END AS ADMIN_REG_ACCEPT_NM
				  , REG_ID
				  , TO_CHAR(REG_DT, 'YYYY.MM.DD HH:MM:SS') AS REG_DT
				  , UPD_ID
				  , UPD_DT
		   FROM TB_ADMIN_INFO
		 WHERE 1=1 
		     AND ADMIN_REG_ACCEPT != 'Y'
		     AND ADMIN_REG_GB = '00'
		<if test="searchGb == 'adminNm'">
		     AND ADMIN_NM LIKE CONCAT('%', #{searchTxt}, '%')
	    </if>
	    <if test="searchGb == 'adminId'">
		     AND ADMIN_ID LIKE CONCAT('%', #{searchTxt}, '%')
	    </if>
         ORDER BY REG_DT DESC 
           LIMIT #{perPage} OFFSET #{startRow}
	</select>
	<!-- 관리자 가입승인관리 조회 [E] -->
	
	<!-- 관리자 가입승인관리 상세 조회 [S] -->
	<select id="selectAdminUserAcceptDtlInfo" resultType="AdminDTO">
		/*AdminMng_SQL.selectAdminUserAcceptDtlInfo*/  
		SELECT A.ADMIN_NO
				 , A.ADMIN_ID
				 , A.ADMIN_NM
				 , A.ADMIN_PH
				 , A.ADMIN_POST_CD
				 , A.ADMIN_ADDRESS
				 , A.ADMIN_D_ADDRESS
				 , A.ADMIN_GENDER
				 , A.ADMIN_REG_ACCEPT
				 , ( SELECT B.REJECT_CN FROM TB_ADMIN_REJECT_INFO B WHERE A.ADMIN_ID = B.ADMIN_ID ) AS ADMIN_REJECT_CN
				 , A.REG_ID
				 , A.REG_DT
				 , A.UPD_ID
				 , A.UPD_DT
		FROM TB_ADMIN_INFO A
	  WHERE 1=1 
	      AND A.ADMIN_NO = #{adminNo}
	      AND A.ADMIN_ID = #{adminId}
	</select>
	<!-- 관리자 가입승인관리 상세 조회 [E] -->
	
	<!-- 관리자 가입승인관리 승인 진행 [S] -->
	<update id="adminUserAcceptUpd" parameterType="AdminDTO">
  		/*AdminMng_SQL.adminUserAcceptUpd*/
	  	UPDATE TB_ADMIN_INFO
	     	 SET ADMIN_REG_ACCEPT = 'Y'
	     	 	 , UPD_ID = #{updId}
	     	 	 , UPD_DT = NOW()
	   	 WHERE 1=1
	   	 	 AND ADMIN_NO = #{adminNo}
	         AND ADMIN_ID = #{adminId}
	</update>
	<!-- 관리자 가입승인관리 승인 진행 [E] -->
	
	<!-- 관리자 관리자 가입승인관리 반려 진행 [S] -->
	<update id="adminUserAcceptDel" parameterType="AdminDTO">
  		/*AdminMng_SQL.adminUserAcceptDel*/
	  	UPDATE TB_ADMIN_INFO
	     	 SET ADMIN_REG_ACCEPT = 'R'
	     	 	 , UPD_ID = #{updId}
	     	 	 , UPD_DT = NOW()
	   	 WHERE 1=1
	   	 	 AND ADMIN_NO = #{adminNo}
	         AND ADMIN_ID = #{adminId}
	</update>
	<!-- 관리자 관리자 가입승인관리 반려 진행 [E] -->
	
	<!-- 관리자 가입승인관리 반려 사유 등록 [S] -->
	<insert id="adminUserRejectCnReg" parameterType="adminDTO">
		/*AdminMng_SQL.adminMenuReg*/
		INSERT INTO TB_ADMIN_REJECT_INFO (
			  admin_id
			, admin_nm
			, reject_no
			, reject_cn
			, REG_ID
			, REG_DT
			, UPD_ID
			, UPD_DT
		) VALUES ( 
		      #{adminId}
		    , #{adminNm}
			, (SELECT FN_GET_UNIQUE_KEY())
			, #{adminRejectCn}
			, #{regId}
			, NOW() 
			, #{updId}
			, NOW()
		)
	</insert>
	<!-- 관리자 가입승인관리 반려 사유 등록 [E] -->

</mapper>